--SAURAV POKAHREL
--01
SELECT 
    p.FIRSTNAME, 
    p.LASTNAME, 
    p.PHONE, 
    TO_CHAR(s.SECTIONSTARTDATE, 'MON DD YYYY HH24:MI AM') AS "SECTIONSTARTTIME", 
    s.SECTIONID, 
    s.COURSEID, 
    p.STATE, 
    p.CITY
FROM SECTIONS s
JOIN PROFESSORS p ON s.PROFESSORID = p.PROFESSORID
WHERE p.STATE = 'CO'
AND TO_CHAR(s.SECTIONSTARTDATE, 'YYYY-MM') = '2020-08'
AND TO_CHAR(s.SECTIONSTARTDATE, 'HH24:MI') = '11:30'
ORDER BY s.SECTIONSTARTDATE, p.LASTNAME, p.FIRSTNAME;

--02
SELECT 
    c.SUBJECTCODE, 
    c.COURSENUMBER, 
    p.FIRSTNAME, 
    p.LASTNAME, 
    TO_CHAR(p.HIREDATE, 'MON DD YYYY HH24:MI AM') AS "HIREDATE", 
    s.LOCATIONID, 
    s.SECTIONID, 
    l.BUILDING, 
    l.ROOM
FROM SECTIONS s
JOIN PROFESSORS p ON s.PROFESSORID = p.PROFESSORID
JOIN COURSES c ON s.COURSEID = c.COURSEID
JOIN LOCATIONS l ON s.LOCATIONID = l.LOCATIONID
WHERE p.FIRSTNAME = 'Lenore' 
AND p.LASTNAME = 'Mann'
ORDER BY c.SUBJECTCODE, c.COURSENUMBER, l.ROOM, s.SECTIONID;

--03
SELECT 
    p.FIRSTNAME, 
    p.LASTNAME, 
    s.CAPACITY, 
    c.SUBJECTCODE, 
    c.COURSENUMBER, 
    TO_CHAR(s.SECTIONSTARTDATE, 'MON DD YYYY HH24:MI AM') AS "Section Start Date"
FROM SECTIONS s
JOIN PROFESSORS p ON s.PROFESSORID = p.PROFESSORID
JOIN COURSES c ON s.COURSEID = c.COURSEID
WHERE s.CAPACITY > 35
AND TRUNC(s.SECTIONSTARTDATE) = TO_DATE('2019-05-06', 'YYYY-MM-DD')
ORDER BY p.LASTNAME, p.FIRSTNAME;

--04
SELECT 
    st.FIRSTNAME,
    st.LASTNAME,
    TO_CHAR(r.REGISTRATIONDATE, 'MM-DD-YYYY HH24:MI AM') AS "Registration Date",
    r.SECTIONID,
    st.STATE AS "ST"
FROM STUDENTS st
JOIN REGISTRATION r ON st.STUDENTID = r.STUDENTID
WHERE st.STATE IN ('UT', 'CO', 'ID')
AND r.REGISTRATIONDATE > TO_DATE('2020-04-14 13:00:00', 'YYYY-MM-DD HH24:MI:SS')
AND r.REGISTRATIONDATE < TO_DATE('2020-04-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
ORDER BY r.REGISTRATIONDATE;

--05
SELECT 
    s.FIRSTNAME, 
    s.LASTNAME, 
    TO_CHAR(r.REGISTRATIONDATE, 'Mon-DD-YYYY HH24:MI AM') AS "Registration Date", 
    r.SECTIONID, 
    r.FINALCLASSGRADE AS "GRD"
FROM STUDENTS s
JOIN REGISTRATION r ON s.STUDENTID = r.STUDENTID
WHERE s.LASTNAME LIKE 'H%'  -- Last name starts with H
  AND s.FIRSTNAME LIKE 'A%i%' -- First name starts with A and contains 'i'
ORDER BY s.LASTNAME, s.FIRSTNAME, r.REGISTRATIONDATE;

--06
SELECT 
    s.COURSEID, 
    s.LOCATIONID, 
    l.BUILDING, 
    c.SUBJECTCODE, 
    c.COURSENUMBER, 
    TO_CHAR(s.SECTIONSTARTDATE, 'Mon DD YYYY HH24:MI AM') AS "STARTSECTIONTIME"
FROM SECTIONS s
JOIN COURSES c ON s.COURSEID = c.COURSEID
JOIN LOCATIONS l ON s.LOCATIONID = l.LOCATIONID
WHERE c.SUBJECTCODE = 'WEB'
  AND s.SECTIONSTARTDATE BETWEEN 
      TO_DATE('2019-04-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS') 
      AND TO_DATE('2019-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
ORDER BY s.COURSEID, c.COURSENUMBER, s.SECTIONSTARTDATE, l.BUILDING;

--07
SELECT 
    s.FIRSTNAME, 
    s.LASTNAME, 
    s.PHONE, 
    s.TUITIONBALANCE, 
    TO_CHAR(r.REGISTRATIONDATE, 'Mon DD YYYY HH24:MI AM') AS "REGDATE"
FROM STUDENTS s
JOIN REGISTRATION r ON s.STUDENTID = r.STUDENTID
WHERE r.REGISTRATIONDATE >= TO_DATE('2020-08-29 08:00:00', 'YYYY-MM-DD HH24:MI:SS')
  AND s.TUITIONBALANCE > 6000
ORDER BY s.TUITIONBALANCE, s.LASTNAME, s.FIRSTNAME, r.REGISTRATIONDATE;

--08
SELECT 
    s.FIRSTNAME, 
    s.LASTNAME, 
    c.SUBJECTCODE, 
    c.COURSENUMBER, 
    TO_CHAR(r.REGISTRATIONDATE, 'YYYY MON DD HH24:MI AM') AS "DATEREGISTERED", 
    c.SUBJECTDESCRIPTION
FROM STUDENTS s
JOIN REGISTRATION r ON s.STUDENTID = r.STUDENTID
JOIN SECTIONS sec ON r.SECTIONID = sec.SECTIONID
JOIN COURSES c ON sec.COURSEID = c.COURSEID
WHERE c.SUBJECTCODE = 'ANTH'
ORDER BY c.SUBJECTCODE, c.COURSENUMBER, r.REGISTRATIONDATE;

--09
SELECT 
    s.FIRSTNAME, 
    s.LASTNAME,
    c.SUBJECTDESCRIPTION,
    c.COURSENUMBER AS "COURS",
    r.FINALCLASSGRADE AS "FGRD"
FROM STUDENTS s
JOIN REGISTRATION r ON s.STUDENTID = r.STUDENTID
JOIN SECTIONS sec ON r.SECTIONID = sec.SECTIONID
JOIN COURSES c ON sec.COURSEID = c.COURSEID
WHERE (c.SUBJECTDESCRIPTION LIKE '%Web%' OR c.SUBJECTDESCRIPTION LIKE '%User Experience%')
    AND c.COURSENUMBER >= '3000' 
    AND c.COURSENUMBER <= '3100'
    AND r.FINALCLASSGRADE IN ('A', 'A-', 'B+', 'B', 'B-')
ORDER BY c.COURSENUMBER, r.FINALCLASSGRADE, s.LASTNAME, s.FIRSTNAME;

--10
SELECT 
    s.FIRSTNAME AS "STDNTFIRST", 
    s.LASTNAME AS "STDNTLAST", 
    p.FIRSTNAME AS "PROFFIRST", 
    p.LASTNAME AS "PROFLAST",
    p.STATE AS "ST",
    p.CITY
FROM STUDENTS s
JOIN REGISTRATION r ON s.STUDENTID = r.STUDENTID
JOIN SECTIONS sec ON r.SECTIONID = sec.SECTIONID
JOIN COURSES c ON sec.COURSEID = c.COURSEID
JOIN PROFESSORS p ON sec.PROFESSORID = p.PROFESSORID
WHERE s.CITY = p.CITY 
  AND p.STATE = 'NV'
ORDER BY s.LASTNAME, s.FIRSTNAME;
